<script>
    const { ipcRenderer } = require('electron'),
        fs = require('fs'),
        exec = require('child_process').exec,
        path = require('path'),
        remote = require('electron').remote;
    window.$ = window.jQuery = require('jquery');
</script>
<div class="encabezado_INV411">
    <a class="nombre_INV411"> HOSPITAL LOCAL SAN MARTIN ESE</a>
    <a class="nitusu_INV411">NIT 892,000,458</a>
    <a class="ivausu_INV411">NO RESPONSABLES DE IVA</a>
    <div class="datos_usu_INV411">
        <a class="direccionusu_INV411"> CL 4 7 34</a>
        <a class="telefonousu_INV411">Tel: 6483035</a>
    </div>
    <a class="ciudadusu_INV411">SAN MARTIN</a>
    <a class="claseserviciousu_INV411">3 IMAGENOLOGIA</a>
    <a class="codigobarras_INV411">NUMERO DE CODIGO DE BARRAS</a>
    <div class="primeralinea_INV411" style="font-size:12px">
        <a class="fechapaciente_INV411"> NOVIEMBRE 15 DEL 2019</a>
        <a class="facturapaciente_INV411"> CARGAR A LA FACTURA: P027040</a>
        <a class="comprobantepaciente_INV411">COMPROBANTE NUMERO: 008217</a>
    </div>
    <div class="segundalinea_INV411" style="font-size:12px">
        <a class="entidadpaciente_INV411">ENTIDAD: CAPITAL SALUD EPSS</a>
        <a class="codigoeps_INV411">CODIGO: EPSS34</a>
        <a class="formapago_INV411">F.PAGO: Hospit.</a>
        <a class="acceso_INV411">ACCESO: UR</a>
    </div>
    <div class="terceralinea_INV411" style="font-size:12px">
        <a class="medotr_INV411">ATIENDE: MONSALVE TAMAYO GUSTAVO</a>
        <a class="especialidad_INV411">Espec: 602 RADIOLOGIA E IMAGENES DIA</a>
        <a class="costo_INV411">COS: 02 CONSULTA EXTERNA</a>
    </div>
    <div class="cuartalinea_INV411" style="font-size:12px">
        <a class="idhistoria_INV411">PACIENTE: 000001120504800 CC</a>
        <!-- <a class="nombrepaciente_INV411">SANDOVAL PEDREROS JHON JAIRO</a> -->
        <a class="us_INV411">US: URGENCIAS</a>
    </div>
    <div class="quintalinea_INV411" style="font-size:12px">
        <a class="ocupacion_INV411">OCUPACION: 999</a>
        <a class="tipousuar_INV411">TIPO USUARIO: SUBSID</a>
        <a class="edad_INV411">EDAD: A023</a>
        <a class="sexo_INV411">SEXO: M</a>
        <a class="ciudad_INV411">CIUDAD: 50689</a>
        <a class="ZONA_INV411">ZONA: U</a>
    </div>
    <div class="sextalinea_INV411" style="font-size:12px">
        <a class="detalle_INV411"> DETALLE: PRIMERA FACTURA DE RX</a>
        <a class="autor_INV411">Autor: 123123123</a>
    </div>
    <a class="remite_INV411" style="font-size:12px">SOLICITA: ARTEGA LOPEZ JOSE IGNACIO</a>
    <table class="tablacodservicio_INV411 table table-bordered table-hover" style="font-size:12px">
        <thead>
            <tr>
                <th scope="col">Codigo</th>
                <th scope="col">Descripcion</th>
                <th scope="col">Cant</th>
                <th scope="col">Valor unit.</th>
                <th scope="col">Valor Total</th>
            </tr>
        </thead>
        <tbody>
        </tbody>
    </table>
    <div class="septimalinea" style="font-size:12px">
        <a class="totalfactura_INV411">TOTAL FACTURA: 1,000</a>
        <a class="copagos_INV411">ABONOS/COPAGOS: </a>
        <a class="saldo_INV411">SALDO: 1,000</a>
    </div>
    <a class="cantidadennumeros_INV411" style="font-size:12px">SON: UN MILLON DE PESOS</a>
    <a class="resoldian_INV411" style="font-size:12px">RESOLUCION DIAN</a>
    <div class="octavalinea_INV411" style="font-size:12px">
        <a class="fechaelaborado_INV411">191128 11:44</a>
        <a>Firma paciente: _____________________________ ______________________________</a>
        <a class="operelabfact_INV411">0101</a>
        <a class="opercorrecfact_INV411">Mod: 0101</a>
        <a class="imprime_INV411">0101</a>
    </div>
</div>
<style>
    .encabezado_INV411 {
        width: 100%;
        height: 100%;
    }

    .nombre_INV411 {
        margin: 0 auto;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .nitusu_INV411 {
        margin: 0 auto;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .ivausu_INV411 {
        margin: 0 auto;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .datos_usu_INV411 {
        display: flex;
        justify-content: space-around;
        width: 20%;
        margin: 0 auto;
    }

    .ciudadusu_INV411 {
        margin: 0 auto;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .claseserviciousu_INV411 {
        margin: 0 auto;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .primeralinea_INV411 {
        margin: 0 auto;
        display: flex;
        width: 100%;
        justify-content: space-between;
        border-left: black solid 0.1px;
        border-right: black solid 0.1px;
        border-top: black solid 0.1px;
    }

    .segundalinea_INV411 {
        margin: 0 auto;
        display: flex;
        width: 100%;
        justify-content: space-between;
        border-left: black solid 0.1px;
        border-right: black solid 0.1px;
    }

    .terceralinea_INV411 {
        margin: 0 auto;
        display: flex;
        width: 100%;
        justify-content: space-between;
        border-left: black solid 0.1px;
        border-right: black solid 0.1px;
    }

    .cuartalinea_INV411 {
        margin: 0 auto;
        display: flex;
        width: 100%;
        justify-content: space-between;
        border-left: black solid 0.1px;
        border-right: black solid 0.1px;
    }

    .quintalinea_INV411 {
        margin: 0 auto;
        display: flex;
        width: 100%;
        justify-content: space-between;
        border-left: black solid 0.1px;
        border-right: black solid 0.1px;
    }

    .sextalinea_INV411 {
        margin: 0 auto;
        display: flex;
        width: 100%;
        justify-content: space-between;
        border-left: black solid 0.1px;
        border-right: black solid 0.1px;
        border-bottom: black solid 0.1px;
    }

    .remite_INV411 {
        margin: 0 auto;
        display: flex;
        width: 100%;
        padding-top: 10px;
        padding-bottom: 10px;
    }

    .tablacodservicio_INV411 {
        margin: 0 auto;
        width: 100%;
    }

    thead {
        border-top: black solid 0.1px;
    }

    tbody {
        text-align: center;
    }
</style>
<script>
    var INV411 = [];
    ipcRenderer.on('ping', (e, data) => {
        INV411 = data.datos;
        $('.nombre_INV411').text(INV411.NOMBREUSU);
        $('.nitusu_INV411').text(INV411.NITUSU);
        $('.ivausu_INV411').text(INV411.IVAUSU);
        $('.direccionusu_INV411').text(INV411.DIRECCIONUSU);
        $('.telefonousu_INV411').text(INV411.TELEFONOUSU);
        $('.claseserviciousu_INV411').text(INV411.CLASESERVICIO);
        $('.comprobantepaciente_INV411').text(INV411.COMPROBANTE)
        $('.fechapaciente_INV411').text(INV411.FECHAFACT);
        $('.facturapaciente_INV411').text(INV411.FACTURA);
        $('.comprobantepaciente_INV411').text(INV411.COMPROBANTE);
        $('.entidadpaciente_INV411').text(INV411.DESCRIPTER);
        $('.codigoeps_INV411').text(INV411.CODIGOEPS);
        $('.formapago_INV411').text(INV411.FPAGO);
        $('.acceso_INV411').text(INV411.PUERTAW);
        $('.medotr_INV411').text(INV411.ATIENDE);
        $('.especialidad_INV411').text(INV411.ESPECIALIDAD);
        $('.costo_INV411').text(INV411.COSTO);
        $('.idhistoria_INV411').text(INV411.PACIENTE);
        $('.us_INV411').text(INV411.UNSERVFACT);
        $('.ocupacion_INV411').text(INV411.OCUPACION);
        $('.edad_INV411').text(INV411.EDAD);
        $('.sexo_INV411').text(INV411.SEXO);
        $('.ciudadusu_INV411').text(INV411.CIUDAD);
        $('.ZONA_INV411').text(INV411.ZONA);
        $('.detalle_INV411').text(INV411.DETALLE);
        $('.autor_INV411').text(INV411.NROAURO);
        $('.remite_INV411').text(INV411.SOLICITA);
        $('.cantidadennumeros_INV411').text(INV411.SON);
        $('.resoldian_INV411').text(INV411.RESOLDIAN);
        $('.operelabfact_INV411').text(INV411.OPERELABFACT);
        $('.opercorrecfact_INV411').text(INV411.OPERCORRECFACT);
        $('.imprime_INV411').text(INV411.ADMINW);

        $('.tipousuar_INV411').text(INV411.TIPOUSUW);
        $('.ciudad_INV411').text(INV411.CIUDAD);
        $('.totalfactura_INV411').text(INV411.VLRTOTAL);
        $('.copagos_INV411').text(INV411.COPAGO);
        $('.saldo_INV411').text(INV411.SALDO);
        $('.fechaelaborado_INV411').text(INV411.FECHAELABORADO);

        if (parseInt(INV411.VLRIVAFACT) == 0) {
            for (var i in INV411.TABLA) {
                $('.tablacodservicio_INV411 tbody').append(
                    '<tr>' +
                    '<th>' + INV411.TABLA[i].ARTFACT + '</th>' +
                    '<td>' + INV411.TABLA[i].DESCRIPCUP + '</td>' +
                    '<td>' + INV411.TABLA[i].CANTFACT + '</td>' +
                    '<td>' + INV411.TABLA[i].VLRFACT + '</td>' +
                    '<td>' + INV411.TABLA[i].VLRTOTAL + '</td>' +
                    '</tr>'
                )
            }
        } if (parseInt(INV411.VLRIVAFACT) > 0) {
            for (var i in INV411.TABLA) {
                alert(INV411.TABLA[i].ARTFACT);
                $('.tablacodservicio_INV411 tbody').append(
                    '<tr>' +
                    '<th>' + INV411.TABLA[i].ARTFACT + '</th>' +
                    '<td>' + INV411.TABLA[i].DESCRIPCUP + '</td>' +
                    '<td>' + INV411.TABLA[i].CANTFACT + '</td>' +
                    '<td>' + INV411.TABLA[i].VLRFACT + '</td>' +
                    '<td>' + INV411.TABLA[i].VLRTOTAL + '</td>' +
                    '</tr>'
                )
            }
            $('.tablacodservicio_INV411 tbody').append(
                '<tr>' +
                '<th>' + '</th>' +
                '<td>' + 'I.V.A.' + '</td>' +
                '<td>' + INV411.VLRIVAFACT + '</td>' +
                '<td>' + + '</td>' +
                '<td>' + + '</td>' +
                '</tr>'
            )
        } if (parseInt(INV411.COPAGO) > 0) {
            switch (INV411.COPAGO) {
                case '1':
                    $('.tablacodservicio_INV411 tbody').append(
                        '<tr>' +
                        '<th>' + '</th>' +
                        '<td>' + 'COPAGOS' + '</td>' +
                        '<td>' + INV411.COPAGO + '</td>' +
                        '<td>' + + '</td>' +
                        '<td>' + + '</td>' +
                        '</tr>'
                    )
                    break;
                case '2':
                    $('.tablacodservicio_INV411 tbody').append(
                        '<tr>' +
                        '<th>' + '</th>' +
                        '<td>' + 'CUOTA MODERADORA' + '</td>' +
                        '<td>' + INV411.COPAGO + '</td>' +
                        '<td>' + + '</td>' +
                        '<td>' + + '</td>' +
                        '</tr>'
                    )
                    break;
                case '3':
                    $('.tablacodservicio_INV411 tbody').append(
                        '<tr>' +
                        '<th>' + '</th>' +
                        '<td>' + 'VALOR A PAGAR' + '</td>' +
                        '<td>' + INV411.COPAGO + '</td>' +
                        '<td>' + + '</td>' +
                        '<td>' + + '</td>' +
                        '</tr>'
                    )
                    break;
            }
        }
        // var nit = INV411.NIT;
        // var url = path.join(`P:\\PROG\\LOGOS\\${nit}.bmp`);

        // fs.readFile(url, function (err, data) {
        //     if (err) throw err;
        //     var dataImg1 = Buffer.from(data).toString('base64');
        //     $('<img/>').attr('src', `data:image/jpeg;base64,${dataImg1}`).appendTo('.logo')
        // });

        // var nitprofe = parseInt(RXI02A.IDRADIOLOGO_RX);
        // var urlprofe = path.join(`P:\\PROG\\DATOS\\17329215.bmp`);
        // fs.readFile(urlprofe, function (err, data) {
        //     if (err) throw err;
        //     var dataImg2 = Buffer.from(data).toString('base64');
        //     $('<img/>').attr('src', `data:image/jpeg;base64,${dataImg2}`).appendTo('.firmaprofe')
        // });

    })
</script>